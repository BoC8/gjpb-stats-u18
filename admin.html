<!DOCTYPE html>
<html lang="fr">

<head>
    <meta charset="UTF-8">
    <title>Admin - Ajouter un match</title>
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
    <style>
        body {
            font-family: Arial;
            padding: 20px;
            max-width: 800px;
            margin: auto;
        }

        input,
        select,
        button {
            display: block;
            margin: 10px 0;
            padding: 8px;
            width: 100%;
        }

        .actions-group {
            margin-top: 20px;
            border-top: 1px solid #ccc;
            padding-top: 20px;
        }

        .inline {
            display: inline-block;
            width: 48%;
            margin-right: 2%;
        }
    </style>
</head>

<body>

    <h1>Ajouter un match</h1>

    <!-- Formulaire Match -->
    <input type="date" id="date">
    <select id="equipe">
        <option>18A</option>
        <option>17</option>
        <option>18B</option>
    </select>
    <input type="text" id="adversaire" placeholder="Adversaire">
    <select id="lieu">
        <option>Domicile</option>
        <option>Extérieur</option>
    </select>
    <select id="competition">
        <option>Phase</option>
        <option>Coupe</option>
        <option>Amical</option>
    </select>
    <input type="number" id="buts_gjpb" placeholder="Buts GJPB">
    <input type="number" id="buts_adv" placeholder="Buts adverses">
    <select id="resultat">
        <option value="V">Victoire</option>
        <option value="N">Nul</option>
        <option value="D">Défaite</option>
    </select>

    <!-- Buteurs -->
    <div class="actions-group">
        <label for="nbButeurs">Nombre de buteurs :</label>
        <input type="number" id="nbButeurs" min="0" max="10">
        <div id="buteurs-container"></div>
    </div>

    <!-- Passeurs -->
    <div class="actions-group">
        <label for="nbPasseurs">Nombre de passeurs :</label>
        <input type="number" id="nbPasseurs" min="0" max="10">
        <div id="passeurs-container"></div>
    </div>

    <button onclick="soumettreMatch()">Enregistrer le match</button>
    <p id="resultatMessage"></p>

    <script>
        const SUPABASE_URL = 'https://lgnwgbctaqaeawzjnuqh.supabase.co'; // remplace ici
        const SUPABASE_ANON_KEY = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImxnbndnYmN0YXFhZWF3empudXFoIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTM4MjYzNjUsImV4cCI6MjA2OTQwMjM2NX0.E0ug5jpRQVh55aq1ewToqol7h7aRPkg7YvwbKpQtVHo';                // remplace ici

        const supabase = window.supabase.createClient(SUPABASE_URL, SUPABASE_ANON_KEY);

        let joueurs = []; // Liste récupérée depuis Supabase

        // Charger la liste des joueurs au chargement de la page
        document.addEventListener("DOMContentLoaded", async () => {
            const { data, error } = await supabase.from('joueurs').select('nom');
            if (error) {
                document.getElementById("resultatMessage").innerText = "Erreur chargement joueurs.";
                return;
            }
            joueurs = data.map(j => j.nom);

            // écouteurs dynamiques
            document.getElementById('nbButeurs').addEventListener('change', () => genererChamps('buteurs-container', 'buteur'));
            document.getElementById('nbPasseurs').addEventListener('change', () => genererChamps('passeurs-container', 'passeur'));
        });

        // Générer des listes déroulantes de joueurs
        function genererChamps(containerId, prefix) {
            const container = document.getElementById(containerId);
            container.innerHTML = ''; // reset
            const nb = document.getElementById(`nb${prefix[0].toUpperCase() + prefix.slice(1)}s`).value;

            for (let i = 0; i < nb; i++) {
                const select = document.createElement('select');
                select.name = `${prefix}_${i}`;
                joueurs.forEach(nom => {
                    const option = document.createElement('option');
                    option.value = nom;
                    option.textContent = nom;
                    select.appendChild(option);
                });
                container.appendChild(select);
            }
        }

        async function soumettreMatch() {
            // À compléter ensuite (insert dans matchs + actions)
            alert("Fonction soumettreMatch à compléter");
        }
    </script>

</body>

</html>